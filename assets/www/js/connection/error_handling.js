// Generated by CoffeeScript 1.3.3
var E, ErrorHandler;

ErrorHandler = (function() {

  function ErrorHandler() {}

  ErrorHandler.prototype.handleError = function(exception) {
    console.log("Sending error: " + (JSON.stringify(exception)));
    Bugsense.notify({
      error: exception
    });
    return main.showDialogWithMessage("Feilen rapporteres til utviklingsteamet. Hvis du ønsker å bidra med ytligere informasjon, merk tidspunktet og send en mail.", "En feil har oppstått");
  };

  ErrorHandler.prototype.hookInto = function() {
    return jQuery("[onclick]").each(function(index, obj) {
      var funksjon;
      if (obj.onclick) {
        console.log("hookin to " + obj);
        funksjon = obj.onclick;
        return obj.onclick = E(funksjon);
      }
    });
  };

  return ErrorHandler;

})();

window.customErrorHandler = new ErrorHandler();

window.onerror = function(error) {
  return window.customErrorHandler.handleError(error);
};

E = function(funksjon) {
  return function() {
    try {
      return funksjon();
    } catch (e) {
      console.log("catched " + (JSON.stringify(e)));
      return window.customErrorHandler.handleError(e);
    }
  };
};
